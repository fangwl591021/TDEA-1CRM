<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆ‘çš„å„€è¡¨æ¿ - èª²ç¨‹ç®¡ç†ç³»çµ±</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #f5f7fa; color: #333; }
        
        .dashboard-container { display: flex; min-height: 100vh; }
        
        /* å´é‚Šæ¬„ */
        .sidebar { width: 250px; background: #2c3e50; color: white; padding: 25px 0; position: fixed; height: 100vh; }
        .user-profile { text-align: center; padding: 20px; border-bottom: 1px solid #34495e; }
        .user-avatar { width: 80px; height: 80px; border-radius: 50%; background: #3498db; display: flex; align-items: center; justify-content: center; font-size: 32px; margin: 0 auto 15px; }
        .user-name { font-size: 1.2em; font-weight: 600; }
        .user-email { font-size: 0.9em; color: #bdc3c7; margin-top: 5px; }
        
        .nav-menu { padding: 20px 0; }
        .nav-item { padding: 15px 25px; display: flex; align-items: center; cursor: pointer; transition: background 0.3s; }
        .nav-item:hover { background: #34495e; }
        .nav-item.active { background: #3498db; }
        .nav-icon { margin-right: 12px; font-size: 20px; }
        
        /* ä¸»å…§å®¹å€ */
        .main-content { flex: 1; margin-left: 250px; padding: 30px; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        h1 { color: #2c3e50; }
        
        /* æ•¸æ“šå¡ç‰‡ */
        .stats-cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 40px; }
        .stat-card { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
        .stat-value { font-size: 2.5em; font-weight: 700; margin-bottom: 10px; }
        .stat-label { color: #7f8c8d; font-size: 0.95em; }
        
        /* èª²ç¨‹å¡ç‰‡ */
        .courses-section { margin-bottom: 40px; }
        .courses-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-top: 20px; }
        .course-card { background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
        .course-header { padding: 20px; border-bottom: 1px solid #eee; }
        .course-title { font-size: 1.2em; font-weight: 600; margin-bottom: 8px; }
        .course-meta { display: flex; justify-content: space-between; color: #666; font-size: 0.9em; }
        .course-body { padding: 20px; }
        .attendance-status { display: inline-block; padding: 5px 12px; border-radius: 20px; font-size: 0.85em; font-weight: 500; }
        .status-upcoming { background: #e3f2fd; color: #1976d2; }
        .status-ongoing { background: #e8f5e9; color: #388e3c; }
        .status-completed { background: #f5f5f5; color: #757575; }
        
        .price-tag { background: #fff3cd; padding: 8px 15px; border-radius: 6px; font-weight: 600; color: #856404; display: inline-block; margin-top: 15px; }
        
        /* å‡ºå‹¤æ—¥æ›† */
        .calendar-section { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); margin-bottom: 40px; }
        .calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 10px; }
        .calendar-day { text-align: center; padding: 15px 5px; border-radius: 8px; cursor: pointer; }
        .calendar-day:hover { background: #f0f7ff; }
        .day-number { font-size: 1.2em; font-weight: 600; margin-bottom: 5px; }
        .day-event { font-size: 0.8em; color: #666; }
        .has-course { background: #e8f5e9; }
        .absent-day { background: #ffebee; }
        
        /* æŒ‰éˆ• */
        .btn { padding: 10px 20px; border-radius: 6px; border: none; cursor: pointer; font-weight: 500; transition: opacity 0.3s; }
        .btn-primary { background: #3498db; color: white; }
        .btn-secondary { background: #f8f9fa; color: #495057; border: 1px solid #dee2e6; }
        
        /* éŸ¿æ‡‰å¼ */
        @media (max-width: 768px) {
            .sidebar { width: 100%; height: auto; position: relative; }
            .main-content { margin-left: 0; }
            .dashboard-container { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- å´é‚Šæ¬„ -->
        <div class="sidebar">
            <div class="user-profile">
                <div class="user-avatar">ğŸ‘¤</div>
                <div class="user-name" id="user-name">ç‹å°æ˜</div>
                <div class="user-email" id="user-email">user@example.com</div>
            </div>
            
            <div class="nav-menu">
                <div class="nav-item active">
                    <span class="nav-icon">ğŸ“Š</span>
                    <span>æˆ‘çš„å„€è¡¨æ¿</span>
                </div>
                <div class="nav-item" onclick="showSection('my-courses')">
                    <span class="nav-icon">ğŸ“š</span>
                    <span>æˆ‘çš„èª²ç¨‹</span>
                </div>
                <div class="nav-item" onclick="showSection('upcoming')">
                    <span class="nav-icon">ğŸ“…</span>
                    <span>å³å°‡åˆ°ä¾†</span>
                </div>
                <div class="nav-item" onclick="showSection('attendance')">
                    <span class="nav-icon">âœ…</span>
                    <span>å‡ºå‹¤è¨˜éŒ„</span>
                </div>
                <div class="nav-item" onclick="showSection('payments')">
                    <span class="nav-icon">ğŸ’³</span>
                    <span>ä»˜æ¬¾è¨˜éŒ„</span>
                </div>
                <div class="nav-item" onclick="showSection('settings')">
                    <span class="nav-icon">âš™ï¸</span>
                    <span>å¸³æˆ¶è¨­å®š</span>
                </div>
                <div class="nav-item" style="margin-top: 40px; color: #e74c3c;" onclick="logout()">
                    <span class="nav-icon">ğŸšª</span>
                    <span>ç™»å‡ºç³»çµ±</span>
                </div>
            </div>
        </div>
        
        <!-- ä¸»å…§å®¹å€ -->
        <div class="main-content">
            <div class="header">
                <h1>æˆ‘çš„å„€è¡¨æ¿</h1>
                <button class="btn btn-primary" onclick="browseCourses()">ç€è¦½èª²ç¨‹</button>
            </div>
            
            <!-- æ•¸æ“šçµ±è¨ˆ -->
            <div class="stats-cards">
                <div class="stat-card">
                    <div class="stat-value" id="total-courses">5</div>
                    <div class="stat-label">ç¸½å ±åèª²ç¨‹æ•¸</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="ongoing-courses">2</div>
                    <div class="stat-label">é€²è¡Œä¸­èª²ç¨‹</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="total-payment">12,800</div>
                    <div class="stat-label">ç¸½æ¶ˆè²»é‡‘é¡</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="attendance-rate">92%</div>
                    <div class="stat-label">å‡ºå‹¤ç‡</div>
                </div>
            </div>
            
            <!-- é€²è¡Œä¸­èª²ç¨‹ -->
            <div class="courses-section">
                <h2>é€²è¡Œä¸­çš„èª²ç¨‹</h2>
                <div class="courses-grid" id="ongoing-courses-list">
                    <!-- èª²ç¨‹å¡ç‰‡æœƒç”± JavaScript ç”¢ç”Ÿ -->
                </div>
            </div>
            
            <!-- å‡ºå‹¤æ—¥æ›† -->
            <div class="calendar-section">
                <div class="calendar-header">
                    <h3>æœ¬æœˆèª²ç¨‹æ—¥æ›†</h3>
                    <div>
                        <button class="btn btn-secondary" onclick="prevMonth()">â† ä¸Šå€‹æœˆ</button>
                        <span id="current-month" style="margin: 0 15px; font-weight: 600;">2024å¹´7æœˆ</span>
                        <button class="btn btn-secondary" onclick="nextMonth()">ä¸‹å€‹æœˆ â†’</button>
                    </div>
                </div>
                <div class="calendar-grid" id="calendar">
                    <!-- æ—¥æ›†æœƒç”± JavaScript ç”¢ç”Ÿ -->
                </div>
            </div>
            
            <!-- è¿‘æœŸå ±å -->
            <div class="courses-section">
                <h2>è¿‘æœŸå ±åçš„èª²ç¨‹</h2>
                <div class="courses-grid" id="recent-courses-list">
                    <!-- è¿‘æœŸèª²ç¨‹å¡ç‰‡ -->
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // ä½¿ç”¨è€…è³‡æ–™ï¼ˆå¯¦éš›æœƒå¾ Line Login å–å¾—ï¼‰
        const userData = {
            name: "ç‹å°æ˜",
            email: "user@example.com",
            lineId: "U1234567890",
            joinDate: "2024-01-15"
        };
        
        // èª²ç¨‹è³‡æ–™ï¼ˆå¯¦éš›æœƒå¾ Google Sheets å–å¾—ï¼‰
        const userCourses = [
            {
                id: "C001",
                title: "å…’ç«¥æ¸¸æ³³å¯†é›†ç­",
                type: "swimming",
                model: "series",
                batch: "ç¬¬1æ¢¯æ¬¡",
                dates: "2024-07-10 è‡³ 2024-07-14",
                days: 5,
                status: "ongoing",
                attendance: 4,
                totalDays: 5,
                price: 2880,
                originalPrice: 3600,
                absentDays: 1
            },
            {
                id: "C002",
                title: "é€±ä¸‰ç¾è¡“èª²å¾Œç­",
                type: "art",
                model: "semester",
                semester: "113ä¸Šå­¸æœŸ",
                dates: "2024-09-04 è‡³ 2025-01-15",
                status: "upcoming",
                price: 4500
            },
            {
                id: "C003",
                title: "ç¾½çƒåŸºç¤è¨“ç·´",
                type: "badminton",
                model: "series",
                batch: "é€±å››æ™šé–“ç­",
                dates: "2024-06-01 è‡³ 2024-07-31",
                status: "completed",
                attendance: 8,
                totalDays: 8,
                price: 3200
            }
        ];
        
        // æ—¥æ›†è³‡æ–™
        const calendarEvents = [
            { date: "2024-07-10", title: "æ¸¸æ³³èª² Day 1", type: "course", status: "attended" },
            { date: "2024-07-11", title: "æ¸¸æ³³èª² Day 2", type: "course", status: "attended" },
            { date: "2024-07-12", title: "æ¸¸æ³³èª² Day 3", type: "course", status: "absent" },
            { date: "2024-07-13", title: "æ¸¸æ³³èª² Day 4", type: "course", status: "attended" },
            { date: "2024-07-14", title: "æ¸¸æ³³èª² Day 5", type: "course", status: "attended" },
            { date: "2024-07-20", title: "ç¾è¡“èª²", type: "course", status: "upcoming" },
            { date: "2024-07-27", title: "ç¾è¡“èª²", type: "course", status: "upcoming" }
        ];
        
        // åˆå§‹åŒ–
        function initDashboard() {
            // è¨­å®šä½¿ç”¨è€…è³‡æ–™
            document.getElementById('user-name').textContent = userData.name;
            document.getElementById('user-email').textContent = userData.email;
            
            // è¨ˆç®—çµ±è¨ˆæ•¸æ“š
            updateStats();
            
            // æ¸²æŸ“é€²è¡Œä¸­èª²ç¨‹
            renderOngoingCourses();
            
            // æ¸²æŸ“è¿‘æœŸèª²ç¨‹
            renderRecentCourses();
            
            // åˆå§‹åŒ–æ—¥æ›†
            initCalendar();
        }
        
        // æ›´æ–°çµ±è¨ˆæ•¸æ“š
        function updateStats() {
            const total = userCourses.length;
            const ongoing = userCourses.filter(c => c.status === 'ongoing').length;
            const totalPayment = userCourses.reduce((sum, course) => sum + course.price, 0);
            
            document.getElementById('total-courses').textContent = total;
            document.getElementById('ongoing-courses').textContent = ongoing;
            document.getElementById('total-payment').textContent = totalPayment.toLocaleString();
            
            // è¨ˆç®—å‡ºå‹¤ç‡
            const coursesWithAttendance = userCourses.filter(c => c.attendance && c.totalDays);
            if (coursesWithAttendance.length > 0) {
                const totalAttendance = coursesWithAttendance.reduce((sum, c) => sum + c.attendance, 0);
                const totalPossible = coursesWithAttendance.reduce((sum, c) => sum + c.totalDays, 0);
                const rate = Math.round((totalAttendance / totalPossible) * 100);
                document.getElementById('attendance-rate').textContent = rate + '%';
            }
        }
        
        // æ¸²æŸ“é€²è¡Œä¸­èª²ç¨‹
        function renderOngoingCourses() {
            const container = document.getElementById('ongoing-courses-list');
            const ongoingCourses = userCourses.filter(c => c.status === 'ongoing' || c.status === 'upcoming');
            
            container.innerHTML = ongoingCourses.map(course => `
                <div class="course-card">
                    <div class="course-header">
                        <div class="course-title">${course.title}</div>
                        <div class="course-meta">
                            <span>${getModelName(course.model)}</span>
                            <span class="attendance-status ${getStatusClass(course.status)}">
                                ${getStatusText(course.status)}
                            </span>
                        </div>
                    </div>
                    <div class="course-body">
                        <p><strong>${course.batch || course.semester || ''}</strong></p>
                        <p>æ—¥æœŸï¼š${course.dates}</p>
                        ${course.attendance ? `<p>å‡ºå‹¤ï¼š${course.attendance}/${course.totalDays} å¤©</p>` : ''}
                        ${course.absentDays ? `<p>è«‹å‡ï¼š${course.absentDays} å¤©</p>` : ''}
                        <div class="price-tag">
                            å¯¦ä»˜é‡‘é¡ï¼š${course.price.toLocaleString()} å…ƒ
                            ${course.originalPrice && course.price < course.originalPrice ? 
                                `<small style="color: #999; display: block;">åŸåƒ¹ ${course.originalPrice.toLocaleString()} å…ƒ</small>` : ''}
                        </div>
                        <button class="btn btn-primary" style="margin-top: 15px; width: 100%;" 
                                onclick="viewCourseDetail('${course.id}')">
                            æŸ¥çœ‹è©³æƒ…
                        </button>
                    </div>
                </div>
            `).join('');
            
            if (ongoingCourses.length === 0) {
                container.innerHTML = '<p style="grid-column: 1/-1; text-align: center; color: #999;">ç›®å‰æ²’æœ‰é€²è¡Œä¸­çš„èª²ç¨‹</p>';
            }
        }
        
        // æ¸²æŸ“è¿‘æœŸèª²ç¨‹
        function renderRecentCourses() {
            const container = document.getElementById('recent-courses-list');
            const recentCourses = userCourses.slice(0, 3); // å–å‰ä¸‰ç­†
            
            container.innerHTML = recentCourses.map(course => `
                <div class="course-card">
                    <div class="course-header">
                        <div class="course-title">${course.title}</div>
                        <div class="course-meta">
                            <span>${getModelName(course.model)}</span>
                            <span class="attendance-status ${getStatusClass(course.status)}">
                                ${getStatusText(course.status)}
                            </span>
                        </div>
                    </div>
                    <div class="course-body">
                        <p>${course.batch || course.semester || ''}</p>
                        <p>${course.dates}</p>
                        <div class="price-tag">${course.price.toLocaleString()} å…ƒ</div>
                    </div>
                </div>
            `).join('');
        }
        
        // æ—¥æ›†åŠŸèƒ½
        let currentDate = new Date();
        
        function initCalendar() {
            renderCalendar(currentDate);
        }
        
        function renderCalendar(date) {
            const container = document.getElementById('calendar');
            const monthYear = document.getElementById('current-month');
            
            // è¨­å®šæœˆä»½æ¨™é¡Œ
            const year = date.getFullYear();
            const month = date.getMonth();
            monthYear.textContent = `${year}å¹´${month + 1}æœˆ`;
            
            // æ¸…ç©ºæ—¥æ›†
            container.innerHTML = '';
            
            // æ˜ŸæœŸæ¨™é¡Œ
            const weekdays = ['æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­'];
            weekdays.forEach(day => {
                const dayEl = document.createElement('div');
                dayEl.textContent = day;
                dayEl.style.fontWeight = '600';
                container.appendChild(dayEl);
            });
            
            // è¨ˆç®—æœˆä»½ç¬¬ä¸€å¤©å’Œæœ€å¾Œä¸€å¤©
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            
            // å¡«è£œå‰é¢çš„ç©ºç™½
            for (let i = 0; i < firstDay.getDay(); i++) {
                const emptyEl = document.createElement('div');
                container.appendChild(emptyEl);
            }
            
            // ç”¢ç”Ÿæ—¥æœŸæ ¼å­
            for (let day = 1; day <= lastDay.getDate(); day++) {
                const dayEl = document.createElement('div');
                dayEl.className = 'calendar-day';
                
                const currentDateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const event = calendarEvents.find(e => e.date === currentDateStr);
                
                if (event) {
                    dayEl.classList.add('has-course');
                    if (event.status === 'absent') {
                        dayEl.classList.add('absent-day');
                    }
                }
                
                dayEl.innerHTML = `
                    <div class="day-number">${day}</div>
                    ${event ? `<div class="day-event">${event.title}</div>` : ''}
                `;
                
                container.appendChild(dayEl);
            }
        }
        
        function prevMonth() {
            currentDate.setMonth(currentDate.getMonth() - 1);
            renderCalendar(currentDate);
        }
        
        function nextMonth() {
            currentDate.setMonth(currentDate.getMonth() + 1);
            renderCalendar(currentDate);
        }
        
        // è¼”åŠ©å‡½æ•¸
        function getModelName(model) {
            const models = {
                'single': 'å–®æ¬¡èª²',
                'series': 'æ¢¯æ¬¡èª²',
                'camp': 'ç‡ŸéšŠèª²',
                'semester': 'å¸¸æ…‹èª²'
            };
            return models[model] || model;
        }
        
        function getStatusClass(status) {
            const classes = {
                'upcoming': 'status-upcoming',
                'ongoing': 'status-ongoing',
                'completed': 'status-completed'
            };
            return classes[status] || '';
        }
        
        function getStatusText(status) {
            const texts = {
                'upcoming': 'å³å°‡é–‹å§‹',
                'ongoing': 'é€²è¡Œä¸­',
                'completed': 'å·²å®Œæˆ'
            };
            return texts[status] || status;
        }
        
        // å°èˆªåŠŸèƒ½
        function showSection(section) {
            alert(`åˆ‡æ›åˆ° ${section} å€å¡Š`);
            // å¯¦éš›æ‡‰è©²é¡¯ç¤ºå°æ‡‰çš„å…§å®¹å€å¡Š
        }
        
        function viewCourseDetail(courseId) {
            alert(`æŸ¥çœ‹èª²ç¨‹ ${courseId} çš„è©³ç´°è³‡æ–™`);
            // å¯¦éš›æ‡‰è©²è·³è½‰åˆ°èª²ç¨‹è©³æƒ…é 
        }
        
        function browseCourses() {
            window.location.href = '../course-catalog.html';
        }
        
        function logout() {
            if (confirm('ç¢ºå®šè¦ç™»å‡ºå—ï¼Ÿ')) {
                // æ¸…é™¤ç™»å…¥ç‹€æ…‹
                alert('å·²ç™»å‡º');
                window.location.href = '../index.html';
            }
        }
        
        // åˆå§‹åŒ–å„€è¡¨æ¿
        initDashboard();
    </script>
</body>
</html>
